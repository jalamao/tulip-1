TULIP_DIR=../..
TULIP_CONFIG=$(TULIP_DIR)/tulip-config
TULIP_VERSION=$(shell ${TULIP_CONFIG} --version)
LIB_EXTENSION=$(shell ${TULIP_CONFIG} --pluginextension)

CXX=g++
CXXFLAGS = -O3 -Wall -DNDEBUG -fPIC -DPIC `${TULIP_CONFIG} --qtincludes` `${TULIP_CONFIG} --cxxflags`
LDFLAGS= -shared `${TULIP_CONFIG} --libs` `${TULIP_CONFIG} --qtlibs`

SRCS= $(ARITY_SRCS) $(ARITY_SEGMENT_SRCS) $(SEGMENT_SRCS)

OBJS=$(SRCS:.cpp=.o)

ARITY_TARGET=libarity-$(TULIP_VERSION).$(LIB_EXTENSION)
ARITY_SEGMENT_TARGET=libaritysegment-$(TULIP_VERSION).$(LIB_EXTENSION)
SEGMENT_TARGET=libsegment-$(TULIP_VERSION).$(LIB_EXTENSION)

all: $(ARITY_TARGET) $(ARITY_SEGMENT_TARGET) $(SEGMENT_TARGET)

clean :
	-rm -f $(ARITY_TARGET) $(ARITY_SEGMENT_TARGET) $(SEGMENT_TARGET) *.o *.d

install: all
	install $(ARITY_TARGET) $(ARITY_SEGMENT_TARGET) $(SEGMENT_TARGET) `${TULIP_CONFIG} --pluginpath` 

ARITY_SRCS=ArityRecClustering.cpp
ARITY_OBJS=$(ARITY_SRCS:.cpp=.o)
$(ARITY_TARGET): $(ARITY_OBJS)
	$(CXX) $(ARITY_OBJS) -o $@ $(LDFLAGS) $(LIBS) 

ARITY_SEGMENT_SRCS=AritySegmentRecClustering.cpp
ARITY_SEGMENT_OBJS=$(ARITY_SEGMENT_SRCS:.cpp=.o)
$(ARITY_SEGMENT_TARGET): $(ARITY_SEGMENT_OBJS)
	$(CXX) $(ARITY_SEGMENT_OBJS) -o $@ $(LDFLAGS) $(LIBS) 

SEGMENT_SRCS=SegmentRecClustering.cpp
SEGMENT_OBJS=$(SEGMENT_SRCS:.cpp=.o)
$(SEGMENT_TARGET): $(SEGMENT_OBJS)
	$(CXX) $(SEGMENT_OBJS) -o $@ $(LDFLAGS) $(LIBS) 
